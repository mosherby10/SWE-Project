


{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <div class="card shadow-sm mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h4>Order #{{ order.id }}</h4>
            <span class="badge
                {% if order.order_status == 'Processing' %}bg-warning
                {% elif order.order_status == 'Shipped' %}bg-primary
                {% elif order.order_status == 'Completed' %}bg-success
                {% else %}bg-danger{% endif %}">
                {{ order.order_status }}
            </span>
        </div>
        <div class="card-body">
            <p><strong>User:</strong> {{ order.user.username }} (ID: {{ order.user.id }})</p>
            <p><strong>Order Date:</strong> {{ order.order_date.strftime("%Y-%m-%d %H:%M") }}</p>

            <h5 class="mt-4">Items</h5>
            <table class="table table-hover shadow-sm">
                <thead class="table-dark">
                    <tr>
                        <th>#</th>
                        <th>Game</th>
                        <th>Quantity</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in order.items %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ item.game.title }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>${{ "%.2f"|format(item.price_at_purchase) }}</td>
                        <td>${{ "%.2f"|format(item.quantity * item.price_at_purchase) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <p class="text-end"><strong>Order Total:</strong> ${{ "%.2f"|format(order.total_price) }}</p>

            <div class="mt-3 d-flex justify-content-between">
                <a href="{{ url_for('admin.orders') }}" class="btn btn-secondary">
                    <i class="bi bi-arrow-left"></i> Back to Orders
                </a>

                {% if order.order_status != 'Cancelled' %}
                <form method="POST">
                    <button type="submit" class="btn btn-danger"
                            onclick="return confirm('Are you sure you want to cancel this order?');">
                        <i class="bi bi-x-circle"></i> Cancel Order
                    </button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
